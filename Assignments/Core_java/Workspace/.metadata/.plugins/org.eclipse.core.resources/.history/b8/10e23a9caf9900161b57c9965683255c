package com.jdbc;

import java.io.File;
import java.io.FileInputStream;
import java.sql.Blob;
import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.sql.Statement;
import java.util.Arrays;

public class Jdbc4 {

	public static void main(String[] args) throws Exception {
//		batchUpdates();
		transactions();
	}
	
	public static void transactions() throws Exception {
		Class.forName("oracle.jdbc.driver.OracleDriver");
		Connection con = DriverManager.getConnection("jdbc:oracle:thin:@localhost:1521:xe","System","root");
		Statement stmt = con.createStatement();
		try {
			con.setAutoCommit(false);
			stmt.executeUpdate("UPDATE EMP_COPY2 SET NAME = 'SHREY' WHERE ID = 1");
			stmt.executeUpdate("UPDATE EMP_COPY2 SET NAME = 'ARCHIT' WHERE ID = 200");
			con.commit();
		}
		catch(SQLException e) {
			con.rollback();
			e.printStackTrace();
		}
		finally {
			con.setAutoCommit(true);
		}
	}
	
	public static void batchUpdates() throws Exception {
		Class.forName("oracle.jdbc.driver.OracleDriver");
		
		Connection con = DriverManager.getConnection(
				"jdbc:oracle:thin:@localhost:1521:xe", "System", "root");
		
		Statement stmt = con.createStatement();
		stmt.executeUpdate("DELETE FROM EMP_COPY2");
		ResultSet rs = stmt.executeQuery("select * from EMP");
		while(rs.next()){
			stmt.addBatch("INSERT INTO EMP_COPY2(ID,NAME,SALARY,COMMISSION,ROLE,DEPT_NO,MANAGER_ID) VALUES ("
					+rs.getInt("ID")+","+
					"'"+rs.getString("NAME")+"',"+
					rs.getDouble("SALARY")+","+
					rs.getDouble("COMMISSION")+","+
					"'"+rs.getString("ROLE")+"',"+
					rs.getInt("DEPT_NO")+","+
					rs.getInt("MANAGER_ID")+
					")");
		}
		int updations[] = stmt.executeBatch();
		System.out.println(Arrays.toString(updations));
	}
	

}
